@namespace HITSBlazor.Pages.Ideas.IdeasList
@using HITSBlazor.Components.Tables.TableActionMenu
@using HITSBlazor.Components.Tables.TableBodyRow
@using HITSBlazor.Models.Ideas.Enums
@using HITSBlazor.Utils.EnumStyles
@using HITSBlazor.Utils.EnumTranslators

<PageTitle>Портал ВШЦТ</PageTitle>

<div class="bg-white ideas-list page-content-with-header">
    <div class="w-100 bg-white p-3">
        <div class="w-100 ideas-header">
            <span class="fs-2 text-primary">Список идей: @_ideas.Count</span>
            <div class="d-flex gap-3">
                @if (showCreateIdeaButton)
                {
                    <button type="button" @onclick="@(() => NavigationService.NavigateToAsync("ideas/create"))" 
                            class="btn d-flex btn-primary">
                        <i class="bi bi-plus-lg fs-5"></i>
                        Создать идею
                    </button>
                }
            </div>
        </div>
        <div class="py-2 d-flex justify-content-between">
            <div class="w-50">
                <div class="w-100">
                    <div class="input-group">
                        <span class="input-group-text fs-6">
                            <i class="bi bi-search"></i>
                        </span>
                        <input type="text" placeholder="Поиск" class="form-control rounded-end" />
                    </div>
                </div>
            </div>
        </div>
        <div class="w-100 d-flex">
            <div class="w-100">
                <table class="table table-hover mb-0">
                    <tbody>
                        @foreach(var idea in _ideas)
                        {
                            <tr>
                                <TableBodyRow>
                                    <div class="bi bi-circle-fill fs-6 mt-1 @(idea.IsChecked ? "text-success" : "text-secondary")">
                                        <div></div>
                                    </div>
                                </TableBodyRow>
                                <TableBodyRow>
                                    <div @onclick="@(() => ShowIdea(idea.Id))" class="data-link">
                                        <div>@idea.Name</div>
                                    </div>
                                </TableBodyRow>
                                <TableBodyRow IsCentered="true">
                                    <div class="px-2 py-1 rounded-4 @idea.Status.GetStyle()">
                                        <div>@idea.Status.GetTranslation()</div>
                                    </div>
                                </TableBodyRow>
                                <TableBodyRow IsCentered="true">
                                    <div>@idea.CreatedAt.ToString("dd.MM.yyyy")</div>
                                </TableBodyRow>
                                <TableBodyRow IsCentered="true">
                                    <div>@idea.ModifiedAt.ToString("dd.MM.yyyy")</div>
                                </TableBodyRow>
                                <TableBodyRow IsCentered="true">
                                    <div class="@idea.PreAssessment.GetStyle()">
                                        <div>@idea.PreAssessment</div>
                                    </div>
                                </TableBodyRow>
                                <TableBodyRow IsCentered="true">
                                    <div class="@idea.Rating.GetStyle()">
                                        <div>@idea.Rating</div>
                                    </div>
                                </TableBodyRow>
                                <TableActionMenu ItemId="@idea.Id"
                                                 OnAction="OnIdeaAction"
                                                 Actions="@(new List<TableAction> { TableAction.View, TableAction.Edit, TableAction.Delete })" />
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
            <div class="idea-filter w-25 bg-white p-2 ms-2 border-start">
                <div class="w-100">
                    <span class="fs-6 fw-semibold">Статус</span>
                    <div class="idea-filter-choices">
                        @foreach (var status in Enum.GetValues<IdeaStatusType>())
                        {
                            <div class="px-2 py-1 rounded-1 idea-filet-choice">
                                <div class="d-flex">
                                    <input type="checkbox"
                                           checked="@SelectedStatuses.Contains(status)"
                                           @onchange="@(e => OnStatusChanged(status, (bool)e.Value!))"
                                           class="form-check-input" />
                                    <span class="form-check-label ms-2">@status.GetTranslation()</span>
                                </div>
                            </div>
                        }
                    </div>
                </div>
                <div class="w-100 d-flex justify-content-center">
                    <button type="button" onclick="@ResetFilters" class="btn d-flex btn-danger">
                        <i class="bi bi-x-lg fs-5"></i>
                        Сбросить фильтры
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>