@namespace HITSBlazor.Pages.Ideas.IdeasList

<PageTitle>Портал ВШЦТ</PageTitle>

<div class="bg-white" style="height: auto; display: flex; flex-direction: column; flex-wrap: nowrap; justify-content: flex-start; overflow-y: scroll; align-items: stretch;">
    <div class="w-100 bg-white p-3">
        <div class="w-100" style="display: flex; flex-direction: row; flex-wrap: nowrap; align-items: center; justify-content: space-between; gap: 16px;">
            <span class="fs-2 text-primary">Список идей: @_ideas.Count</span>
            <div class="d-flex gap-3">
                @if (showCreateIdeaButton)
                {
                    <button type="button" @onclick="@(() => NavigationService.NavigateToAsync("ideas/create"))" 
                            class="btn d-flex btn-primary">
                        <i class="bi bi-plus-lg fs-5"></i>
                        Создать идею
                    </button>
                }
            </div>
        </div>
        <div class="py-2 d-flex justify-content-between">
            <div class="w-50">
                <div class="w-100">
                    <div class="input-group">
                        <span class="input-group-text fs-6">
                            <i class="bi bi-search"></i>
                        </span>
                        <input type="text" placeholder="Поиск" class="form-control rounded-end" />
                    </div>
                </div>
            </div>
        </div>
        <div class="w-100 d-flex">
            <div class="w-100">
                <table class="table table-hover mb-0">
                    @foreach(var idea in _ideas)
                    {
                        <tbody>
                            <tr>
                                <td class="@tableDataClass">
                                    <div class="@tableDataContentClass">
                                        <div class="bi bi-circle-fill fs-6 mt-1 @(idea.IsChecked ? "text-success" : "text-secondary")">
                                            <div></div>
                                        </div>
                                    </div>
                                </td>
                                <td class="@tableDataClass">
                                    <div class="@tableDataContentClass">
                                        <div @onclick="@(() => ShowIdea(idea.Id))" style="cursor: pointer;">
                                            <div>@idea.Name</div>
                                        </div>
                                    </div>
                                </td>
                                <td class="@tableDataClass">
                                    <div class="@tableDataContentCenterClass">
                                        <div class="px-2 py-1 rounded-4 @GetStatusStyle(idea.Status)">
                                            <div>@GetStatusName(idea.Status)</div>
                                        </div>
                                    </div>
                                </td>
                                <td class="@tableDataClass">
                                    <div class="@tableDataContentCenterClass">
                                        <div class="">
                                            <div>@idea.CreatedAt.ToString("dd.MM.yyyy")</div>
                                        </div>
                                    </div>
                                </td>
                                <td class="@tableDataClass">
                                    <div class="@tableDataContentCenterClass">
                                        <div class="">
                                            <div>@idea.ModifiedAt.ToString("dd.MM.yyyy")</div>
                                        </div>
                                    </div>
                                </td>
                                <td class="@tableDataClass">
                                    <div class="justify-content-center @tableDataContentClass">
                                        <div class="@GetRatingStyle((double)idea.PreAssessment)">
                                            <div>@idea.PreAssessment</div>
                                        </div>
                                    </div>
                                </td>
                                <td class="@tableDataClass">
                                    <div class="justify-content-center @tableDataContentClass">
                                        @if (idea.Rating is not null)
                                        {
                                            <div class="@GetRatingStyle((double)idea.Rating)">
                                                <div>@idea.Rating</div>
                                            </div>
                                        }
                                        else
                                        {
                                            <div>
                                                <div></div>
                                            </div>
                                        }
                                    </div>
                                </td>
                                <td class="py-3">
                                    <div @onclick="ChangeDropdownMenuStatus"
                                         class="float-end"
                                         style="min-width: 24px; max-width: 24px; height: 24px; min-height: 24px; max-height: 24px; border-radius: 50%; width: 100%; cursor: pointer; display: flex; flex-direction: row; flex-wrap: nowrap; align-items: center; justify-content: center; transition: all .2s ease-out;">
                                        <i class="bi bi-three-dots fs-5"></i>
                                        <div class="dropdown-menu @(dropdownMenuIsShowed ? "show" : "")"
                                             style="@(dropdownMenuIsShowed ? "position: absolute; inset: 0px auto auto 0px; margin: 0px; transform: translate(1504px, 234px);" : "")"
                                             data-popper-placement="@(dropdownMenuIsShowed ? "bottom-start" : "")">
                                            <ul class="list-group list-group-flush">
                                                <li @onclick="@(() => ShowIdea(idea.Id))" class="list-group-item list-group-item-action px-2 py-1">Просмотреть</li>
                                                <li class="list-group-item list-group-item-action px-2 py-1">Редактировать</li>
                                                <li class="list-group-item list-group-item-action px-2 py-1 text-danger">Удалить</li>
                                            </ul>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    }
                </table>
            </div>
            <div class="w-25 bg-white p-2 ms-2 border-start"
                 style="display: flex; flex-direction: column; flex-wrap: nowrap; align-items: stretch; justify-content: flex-start; gap: 8px;">
                 <div class="w-100">
                     <span class="fs-6 fw-semibold">Статус</span>
                    <div style="max-height: 192px; overflow-y: scroll;">
                        @foreach (var status in AllStatuses)
                        {
                            <div class="px-2 py-1 rounded-1" style="@filterChoiceStyle">
                                <div class="d-flex">
                                    <input type="checkbox"
                                           checked="@SelectedStatuses.Contains(status.Value)"
                                           @onchange="@(e => OnStatusChanged(status.Value, (bool)e.Value!))"
                                           class="form-check-input" />
                                    <span class="form-check-label ms-2">@status.Text</span>
                                </div>
                            </div>
                        }
                     </div>
                 </div>
                 <div class="w-100 d-flex justify-content-center">
                    <button type="button" onclick="@ResetFilters" class="btn d-flex btn-danger">
                        <i class="bi bi-x-lg fs-5"></i>
                         Сбросить фильтры
                     </button>
                 </div>
            </div>
        </div>
    </div>
</div>

