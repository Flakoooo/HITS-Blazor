@namespace HITSBlazor.Layout
@using Microsoft.AspNetCore.Components.Web

@if (IsOpened)
{
    <div id="@Id"
         class="@GetModalClass()"
         @onclick="HandleBackdropClick"
         @onclick:stopPropagation="true">
        @ChildContent
    </div>
}

@code {
    [Parameter] public string? Id { get; set; }
    [Parameter] public bool IsOpened { get; set; }
    [Parameter] public string? ClassName { get; set; }
    [Parameter] public bool AllowOutsideClose { get; set; } = true;
    [Parameter] public EventCallback OnOutsideClose { get; set; }
    [Parameter] public RenderFragment? ChildContent { get; set; }

    private string GetModalClass()
    {
        var classes = new List<string> { "modal-layout" };

        if (!string.IsNullOrEmpty(ClassName))
            classes.Add(ClassName);

        return string.Join(" ", classes);
    }

    private async Task HandleBackdropClick()
    {
        if (AllowOutsideClose)
            await OnOutsideClose.InvokeAsync();
    }

    public void Open() => IsOpened = true;
    public void Close() => IsOpened = false;
    public void Toggle() => IsOpened = !IsOpened;
}