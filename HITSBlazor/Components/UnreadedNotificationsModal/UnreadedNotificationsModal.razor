@namespace HITSBlazor.Components.UnreadedNotificationsModal
@using HITSBlazor.Components.NotificationTab
@using HITSBlazor.Components.Typography
@using HITSBlazor.Components.Button
@using HITSBlazor.Models.Common.Entities

<div class="w-100 d-flex flex-column gap-3">
    <div class="d-flex justify-content-between align-items-center gap-3 w-100">
        <Typography ClassName="fs-5 text-primary">
            Непрочитано (@UnreadedNotifications?.Count ?? 0)
        </Typography>

        @if (UnreadedNotifications != null && UnreadedNotifications.Any())
        {
            <Button Type="button"
                    Variant="primary"
                    AppendIconName="bi bi-check-all fs-4"
                    OnClick="MarkAllAsRead">
                Прочитать все
            </Button>
        }
    </div>

    @if (UnreadedNotifications == null || !UnreadedNotifications.Any())
    {
        <div class="w-100 text-center text-secondary">
            <Typography>У вас нет непрочитанных уведомлений</Typography>
        </div>
    }
    else
    {
        @foreach (var notification in UnreadedNotifications)
        {
            <NotificationTab Notification="notification"
                            OnRead="OnReadNotification"
                            OnAddFavorite="OnAddFavorite"
                            OnRemoveFavorite="OnRemoveFavorite" />
        }
    }
</div>

@code {
    [Parameter] public List<Notification>? UnreadedNotifications { get; set; }
    [Parameter] public EventCallback<Notification> OnReadNotification { get; set; }
    [Parameter] public EventCallback<Notification> OnAddFavorite { get; set; }
    [Parameter] public EventCallback<Notification> OnRemoveFavorite { get; set; }
    [Parameter] public EventCallback OnMarkAllAsRead { get; set; }

    private async Task MarkAllAsRead()
    {
        if (OnMarkAllAsRead.HasDelegate)
        {
            await OnMarkAllAsRead.InvokeAsync();
        }
    }
}